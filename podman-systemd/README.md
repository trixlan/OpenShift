# Autostart Podman with Systemd

Create a container (not as root)
```console
$ podman run -d --network quarkus --name mariadb-quarkus -e MARIADB_USER=mariadb -e MARIADB_PASSWORD=mariadb -e MARIADB_ROOT_PASSWORD=mariadb -e MARIADB_DATABASE=quarkus -p 3306:3306 mariadb:latest
```

Generate the systemd files
```console
$ podman generate systemd -f --name mariadb-quarkus 
```
Create the ***container-mariadb-quarkus.service*** file

```services
# container-mariadb-quarkus.service
# autogenerated by Podman 3.3.1
# Tue Aug 16 13:40:44 CDT 2022

[Unit]
Description=Podman container-mariadb-quarkus.service
Documentation=man:podman-generate-systemd(1)
Wants=network-online.target
After=network-online.target
RequiresMountsFor=/run/user/1000/containers

[Service]
Environment=PODMAN_SYSTEMD_UNIT=%n
Restart=on-failure
TimeoutStopSec=70
ExecStart=/usr/bin/podman start mariadb-quarkus
ExecStop=/usr/bin/podman stop -t 10 mariadb-quarkus
ExecStopPost=/usr/bin/podman stop -t 10 mariadb-quarkus
PIDFile=/run/user/1000/containers/overlay-containers/143579c784f5cf65c27de704f77015e6f4c0a9a5bbb1a04d4f72ac4b9a36b654/userdata/conmon.pid
Type=forking

[Install]
WantedBy=multi-user.target default.target
```

Create the systemd user directory
```console
$ mkdir -p ~/.config/systemd/user
```

Copy the file to ```~/.config/systemd/user```
```console
# sudo cp container-mariadb-quarkus.service ~/.config/systemd/user 
```

Check the last line with ```WantedBy=multi-user.target default.target```

Enable service & enable lingering for the user
```console
$ systemctl --user daemon-reload
$ systemctl --user enable container-mariadb-quarkus
$ systemctl --user start container-mariadb-quarkus
$ loginctl enable-linger $USER
```

You can reboot the machine!!!

*loginctl... - Configure Systemd Service to Continue to Run when the user session ends

